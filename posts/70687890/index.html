<!DOCTYPE html>
<html>
<head>
    

    
<!-- Tencent Speed -->
<script>var _speedMark = new Date()</script>
<!-- End Tencent Speed -->
<!-- Tencent Analysis -->
<script async src="//tajs.qq.com/stats?sId=65355341"></script>
<!-- End Tencent Analysis -->


    



    <meta charset="utf-8">
    <!-- HTTP 1.1 -->  
    <meta http-equiv="pragma" content="no-cache">  
    <!-- HTTP 1.0 -->  
    <meta http-equiv="cache-control" content="no-cache">
    
    
    
    <title>
        Unity3D游戏开发之编辑器扩展程序开发实例 - Payne&#39;s Blog
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Unity3D,编辑器,扩展">
    <meta name="description" content="&amp;emsp;&amp;emsp;各位朋友大家好，欢迎关注我的博客，我的博客地址是http://www.qinyuanpei.com。今天我们来说说如何在Unity3D中为编辑器开发扩展程序。提到扩展程序，相信大家都不会陌生了。不管是Google的Chrome浏览器还是经典的FireFox，这些浏览器最为人所称道的就是它支持各种各样的扩展。扩展程序是一种插件，它遵循插件式设计的原则，可以随时在宿主程序中安装">
<meta name="keywords" content="Unity3D,编辑器,扩展">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity3D游戏开发之编辑器扩展程序开发实例">
<meta property="og:url" content="http://qinyuanpei.github.io/posts/70687890/index.html">
<meta property="og:site_name" content="Payne&#39;s Blog">
<meta property="og:description" content="&amp;emsp;&amp;emsp;各位朋友大家好，欢迎关注我的博客，我的博客地址是http://www.qinyuanpei.com。今天我们来说说如何在Unity3D中为编辑器开发扩展程序。提到扩展程序，相信大家都不会陌生了。不管是Google的Chrome浏览器还是经典的FireFox，这些浏览器最为人所称道的就是它支持各种各样的扩展。扩展程序是一种插件，它遵循插件式设计的原则，可以随时在宿主程序中安装">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://7wy477.com1.z0.glb.clouddn.com/imgs_动态生成Prefab效果演示.png">
<meta property="og:image" content="http://7wy477.com1.z0.glb.clouddn.com/imgs_图集打包效果演示.png">
<meta property="og:updated_time" content="2018-07-17T02:09:56.607Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity3D游戏开发之编辑器扩展程序开发实例">
<meta name="twitter:description" content="&amp;emsp;&amp;emsp;各位朋友大家好，欢迎关注我的博客，我的博客地址是http://www.qinyuanpei.com。今天我们来说说如何在Unity3D中为编辑器开发扩展程序。提到扩展程序，相信大家都不会陌生了。不管是Google的Chrome浏览器还是经典的FireFox，这些浏览器最为人所称道的就是它支持各种各样的扩展。扩展程序是一种插件，它遵循插件式设计的原则，可以随时在宿主程序中安装">
<meta name="twitter:image" content="http://7wy477.com1.z0.glb.clouddn.com/imgs_动态生成Prefab效果演示.png">
    
        <link rel="alternate" type="application/atom+xml" title="Payne&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/assets/images/favicon.ico">
    <link rel="stylesheet" href="/assets/styles/style.css?v=1.7.1">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/assets/images/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/assets/images/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Payne</h5>
          <a href="mailto:qinyuanpei@163.com" title="qinyuanpei@163.com" class="mail">qinyuanpei@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/books"  >
                <i class="icon icon-lg icon-bookmark"></i>
                读书
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/movies"  >
                <i class="icon icon-lg icon-film"></i>
                电影
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/works"  >
                <i class="icon icon-lg icon-code"></i>
                作品
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Unity3D游戏开发之编辑器扩展程序开发实例</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Unity3D游戏开发之编辑器扩展程序开发实例</h1>
        <h5 class="subtitle">
            
                <time datetime="2015-03-31T00:53:22.000Z" itemprop="datePublished" class="page-time">
  2015-03-31
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/游戏开发/">游戏开发</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>目录</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#常用的命名空间和类"><span class="post-toc-number">1.</span> <span class="post-toc-text">常用的命名空间和类</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Unity3D编辑器扩展程序开发实例"><span class="post-toc-number">2.</span> <span class="post-toc-text">Unity3D编辑器扩展程序开发实例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#案例1-快速修改贴图类型"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">案例1 快速修改贴图类型</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#案例2-动态生成Prefab"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">案例2 动态生成Prefab</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#案例3-快速为Sprite设置图集tag"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">案例3 快速为Sprite设置图集tag</span></a></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-Unity3D游戏开发之编辑器扩展程序开发实例"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Unity3D游戏开发之编辑器扩展程序开发实例</h1>
        <div class="post-meta">
            <time class="post-time" title="2015-03-31 00:53:22" datetime="2015-03-31T00:53:22.000Z"  itemprop="datePublished">2015-03-31</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/游戏开发/">游戏开发</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            
    <span>
        <i class="icon icon-clock-o"></i>
        21 min.
    </span>
    
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>&emsp;&emsp;各位朋友大家好，欢迎关注我的博客，我的博客地址是<a href="http://www.qinyuanpei.com" target="_blank" rel="noopener">http://www.qinyuanpei.com</a>。今天我们来说说如何在Unity3D中为编辑器开发扩展程序。提到扩展程序，相信大家都不会陌生了。不管是Google的Chrome浏览器还是经典的FireFox，这些浏览器最为人所称道的就是它支持各种各样的扩展。扩展程序是一种插件，它遵循插件式设计的原则，可以随时在宿主程序中安装、卸载而不会影响宿主程序的正常运行。我们知道在Unity3D中有各种各样的插件，如NGUI、2DToolKit、EasyTouch等等都是一种扩展程序。扩展程序在丰富宿主程序功能的基础上，可以帮助宿主程序完成大量额外的工作。可以说正是因为Unity3D拥有大量的插件和资源支持，Unity3D才能够受到大家如此的追捧。可是作为一个有节操的程序员，如果仅仅会使用工具，那么我们和普通用户有什么区别啊，所以在今天的文章中博主将通过三个具体的实例来教大家如何为Unity3D的编辑器开发扩展程序，希望对大家学习Unity3D技术有所帮助！</p>
<a id="more"></a>
<h1 id="常用的命名空间和类"><a href="#常用的命名空间和类" class="headerlink" title="常用的命名空间和类"></a>常用的命名空间和类</h1><p>&emsp;&emsp;开发Unity3D编辑器扩展程序的命名空间主要是UnityEditor，在该命名空间下常用的类有EditorGUI、EditorGUILayout、EditorWindow(可能还有其它的类，不过到目前为止博主就用过这些，如果有其它的类，欢迎大家来补充啊)。为Unity3D编辑器开发的扩展程序同样是一种脚本，通常需要将脚本文件放在项目资源文夹下的Editor文件夹中，即Assets/Editor。不过该脚本不再继承自MonoBehaviour，具体的内容我们会放到后面的实例中来讲Unity3D编辑器扩展程序的形式通常有两种，一种是没有界面的(如案例1)、一种是有界面的(如案例2、案例3)。对于没有界面的这种扩展程序，我们只需要定义一个类(无需继承任何父类)然后再这个类中定义一个静态的方法就可以了;而对于有界面的这种扩展程序，我们需要让定义的这个类继承EditorWindow并实现OnGUI()方法,因为在OnGUI()方法中我们将会对扩展程序的界面进行绘制，不过无需担心啦，因此扩展程序的界面绘制和Unity3D脚本中的OnGUI()方法是相似的，我们要做的就是要熟悉常见的控件。好了，下面进入今天的实战环节，大家准备好了吗？</p>
<h1 id="Unity3D编辑器扩展程序开发实例"><a href="#Unity3D编辑器扩展程序开发实例" class="headerlink" title="Unity3D编辑器扩展程序开发实例"></a>Unity3D编辑器扩展程序开发实例</h1><h2 id="案例1-快速修改贴图类型"><a href="#案例1-快速修改贴图类型" class="headerlink" title="案例1 快速修改贴图类型"></a>案例1 快速修改贴图类型</h2><p>&emsp;&emsp;Unity3D4.6版本的一个重要更新就是UGUI和Unity2D的支持，因为有了对Unity2D的支持，所以Unity3D的贴图类型就增加了一个Sprite的类型。如果导入到Unity3D中的贴图是那种打好的小图的图集，那么Unity3D能够自动识别为Sprite类型。可是对于那种单张的贴图，Unity3D默认还是按照默认的设置来处理，因此如果每次需要用到这些图片，就必须手动地将其TextureType设为sprite，如果贴图数量比较少，那么手动修改也没有什么了。可是如果项目中的贴图数量较多的话，这样一张一张地去调整TextureType可能会浪费大量的时间啊！怎么办呢？简单！写代码！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">using UnityEngine;</span><br><span class="line">using UnityEditor;</span><br><span class="line">using System.Collections;</span><br><span class="line"></span><br><span class="line">public class ImportSprite</span><br><span class="line">&#123;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 批量将贴图格式转换为Sprite</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    [MenuItem(&quot;Tools/ConvertToSprite&quot;)]</span><br><span class="line">    static void ConvertToSprite()</span><br><span class="line">    &#123;</span><br><span class="line">        //获取所有被选中的物体</span><br><span class="line">        Object[] selection=(Object[])Selection.objects;</span><br><span class="line">        //合法性处理</span><br><span class="line">        if(selection.Length==0) return;</span><br><span class="line">        //批量导入贴图</span><br><span class="line">        foreach(Object obj in selection)</span><br><span class="line">        &#123;</span><br><span class="line">            //取得每一张贴图</span><br><span class="line">            Texture texture=(Texture)obj;</span><br><span class="line">            //获得贴图路径</span><br><span class="line">            string localpath=AssetDatabase.GetAssetPath(texture);</span><br><span class="line">            //贴图导入</span><br><span class="line">            TextureImporter importer=(TextureImporter)AssetImporter.GetAtPath(localpath);</span><br><span class="line">            //设置贴图类型</span><br><span class="line">            importer.textureType=TextureImporterType.Sprite;</span><br><span class="line">            //导入项目资源</span><br><span class="line">            AssetDatabase.ImportAsset(localpath);</span><br><span class="line">        &#125;</span><br><span class="line">        //刷新项目资源</span><br><span class="line">        AssetDatabase.Refresh();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;我们将这个脚本放到Editor文件夹中，如果不出现什么意外的话，Unity3D的菜单栏中会增加一个Tools的菜单项，该菜单项目前只有一个子菜单项ConvertToSprite。好了，现在我们要做的事情就是在项目资源文件夹中选中要转换成sprite类型的贴图，然后单击Tools-&gt;ConvertToSprite。很快(具体有多快可以自己在编辑器窗口中去尝试，总之就是很快就对了，哈哈)所有的贴图的都如我们所愿地被转换成了sprite类型，此时此刻你有没有懊悔当年手动创建的92个空物体，反正博主是后悔当初做塔防游戏的时候手动创建了92个空物体，如果那个时候我知道Unity3D可以做这些事情，我打死都不会手动去创建92个空物体的，现在想想都佩服当时自己的勇气啊。好了，作为第一个编辑器扩展程序，我们稍微总结下主要的内容：</p>
<ul>
<li>在Unity3D中我们可以通过TextureImporter、ModelImporter、AudioImporter、MovieImporter等来分别向Unity3D中导入贴图、模型、音频、视频等等，经过设置后最终通过AssetDatabase.ImportAsset()来将其添加到项目中热完全，最后需要使用AssetDatabase.Refresh()方法来刷新本地资源，使导入的资源生效。</li>
<li>Selection.objects取得的物体无法区分是从场景中选取的还是从项目资源文件夹中选取的，如果需要从场景中来选取，建议使用Selection.transforms来代替。<h2 id="案例2-动态生成Prefab"><a href="#案例2-动态生成Prefab" class="headerlink" title="案例2 动态生成Prefab"></a>案例2 动态生成Prefab</h2>&emsp;&emsp;首先让我们来回顾一下大家平时制作Prefab的流程：</li>
<li>在项目资源文件夹中选取素材拖放到场景中</li>
<li>在场景中调整名称、位置、缩放、组件等等</li>
<li>将物体拖放到Prefabs文件夹下生成Prefab<br>尽管这是Unity3D官方推荐的一种做法，可是如果我们现在有大量的Prefab要制作怎么办呢？一个最直观的例子就是游戏里的敌人。在一个中等规模的游戏中，敌人的种类通常很多，而且每一个敌人的行为可能都不相同。然后从宏观的角度来看，敌人的大部分特征都是相同的，因此我们这里考虑使用程序动态生成Prefab，这里假定Prefab不需要附加脚本，因为如何给Prefab附加脚本博主还没有研究出来。好了，下面我们来看代码：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">using UnityEngine;</span><br><span class="line">using UnityEditor;</span><br><span class="line">using System.Collections;</span><br><span class="line"></span><br><span class="line">public class PrefabWrap : EditorWindow &#123;</span><br><span class="line"></span><br><span class="line">    //预设物体名称</span><br><span class="line">    private string prefabName;</span><br><span class="line">    //预设物体tag</span><br><span class="line">    private static string prefabTag;</span><br><span class="line">    //预设物体Layer</span><br><span class="line">    private static int  prefabLayer;</span><br><span class="line">    //当前插件窗口实例</span><br><span class="line">    private static PrefabWrap instance;</span><br><span class="line">    </span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 显示插件窗口</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    [MenuItem(&quot;Tools/PrefabWrapTool&quot;)]</span><br><span class="line">    static void PrefabWrapTool()</span><br><span class="line">    &#123;</span><br><span class="line">        //获取当前窗口实例</span><br><span class="line">        instance=EditorWindow.GetWindow&lt;PrefabWrap&gt;();</span><br><span class="line">        //显示窗口</span><br><span class="line">        instance.Show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 在OnGUI方法中实现界面定制</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    private void OnGUI()</span><br><span class="line">    &#123;</span><br><span class="line">        //绘制一个文本框</span><br><span class="line">        prefabName=EditorGUILayout.TextField(&quot;预设物体名称:&quot;,prefabName);</span><br><span class="line">        //绘制预设物体标签选择框</span><br><span class="line">        prefabTag=EditorGUILayout.TagField(&quot;预设物体tag:&quot;,prefabTag);</span><br><span class="line">        //绘制预设物体层级选择框</span><br><span class="line">        prefabLayer=EditorGUILayout.LayerField(&quot;预设物体Layer:&quot;,prefabLayer);</span><br><span class="line">        //绘制一个按钮</span><br><span class="line">        if(GUILayout.Button(&quot;生成预设物体&quot;,GUILayout.Height(20)))</span><br><span class="line">        &#123;</span><br><span class="line">            if(prefabName!=string.Empty)</span><br><span class="line">            &#123;</span><br><span class="line">                CreatePrefab(prefabName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 批量创建Prefab</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    static void CreatePrefab(string name)</span><br><span class="line">    &#123;</span><br><span class="line">        //获取所有被选中的物体</span><br><span class="line">        Object[] selection=(Object[])Selection.objects;</span><br><span class="line">        //合法性处理</span><br><span class="line">        if(selection.Length==0) return;</span><br><span class="line">        //批量处理</span><br><span class="line">        foreach(Object obj in selection)</span><br><span class="line">        &#123;</span><br><span class="line">            //生成预设</span><br><span class="line">            GameObject prefab=(GameObject)PrefabUtility.CreatePrefab(&quot;Assets/Prefabs/&quot;+name+&quot;.prefab&quot;,(GameObject)obj);</span><br><span class="line">            //设置tag和Layer</span><br><span class="line">            prefab.tag=prefabTag;</span><br><span class="line">            prefab.layer=prefabLayer;</span><br><span class="line">            //导入项目</span><br><span class="line">            AssetDatabase.ImportAsset(AssetDatabase.GetAssetPath(prefab));</span><br><span class="line">        &#125;</span><br><span class="line">        //刷新本地资源</span><br><span class="line">        AssetDatabase.Refresh();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //当界面发生变化时重绘</span><br><span class="line">    void OnInspectorUpdate() </span><br><span class="line">    &#123;</span><br><span class="line">        Repaint();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;首先我们让这个脚本继承自EditorWindow，这样它将在Unity3D中显示一个窗口。在OnGUI()方法中我们定义了窗口需要绘制的内容为一个文本框、两个选择框和一个按钮，当单击按钮后会执行CreatePrefab()方法。当界面发生变化的时候，需要对窗口进行重绘。最终的程序演示效果如下：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://7wy477.com1.z0.glb.clouddn.com/imgs_动态生成Prefab效果演示.png" alt="动态生成Prefab效果演示" title="">
                </div>
                <div class="image-caption">动态生成Prefab效果演示</div>
            </figure>
<p>&emsp;&emsp;当我们在场景中选择好物体后，只要填好预设物体的名称、tag、Layer就可以直接生成Prefab了，不过这里有个问题，因为生成Prefab必须要传入一个GameObject，因此如果直接选择项目资源文件夹里的内容可能会报错，因为你选择的不是一个GameObject。博主做这样一个功能的初衷原本是想直接为每一个精灵图片生成预设文件，现在看来需要寻找其它的方法了，不过基本思路是创建一个空物体，然后向这个空物体中增加子物体，如果大家对此有兴趣的话，可以结合本文的方法自行去尝试。</p>
<h2 id="案例3-快速为Sprite设置图集tag"><a href="#案例3-快速为Sprite设置图集tag" class="headerlink" title="案例3 快速为Sprite设置图集tag"></a>案例3 快速为Sprite设置图集tag</h2><p>&emsp;&emsp;接下来这个案例呢，同样是和贴图有关的内容。我们知道在没有UGUI以前，我们使用NGUI的时候要做的第一件事情就是把要用到的贴图打成图集，现在在Unity3D里面我们可以通过贴图的Packing Tag来实现图集打包，就是说具有相同Packing Tag的物体会被打到一张大图上，这样做的好处是节省资源。如果大家对这部分内容不太熟悉，可以了解下我的这篇文章<a href=""></a>。既然明白了原理，那么我们为什么不来尝试着通过程序将这件事情一次完成呢？好了，直接给出代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">using UnityEngine;</span><br><span class="line">using UnityEditor;</span><br><span class="line">using System.Collections;</span><br><span class="line"></span><br><span class="line">public class PackageTools : EditorWindow </span><br><span class="line">&#123;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 图集标签    </span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    private string tagName;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 当前实例</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    private static PackageTools instance;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 在OnGUI方法中实现界面定制</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    private void OnGUI()</span><br><span class="line">    &#123;</span><br><span class="line">        //绘制一个文本框</span><br><span class="line">        tagName=EditorGUILayout.TextField(&quot;PackageTagName:&quot;,tagName);</span><br><span class="line">        //绘制一个按钮</span><br><span class="line">        if(GUILayout.Button(&quot;Package&quot;,GUILayout.Height(20)))</span><br><span class="line">        &#123;</span><br><span class="line">            if(tagName!=string.Empty)</span><br><span class="line">            &#123;</span><br><span class="line">                PackgeTextureWidthTag(tagName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 显示插件窗口</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    [MenuItem(&quot;Tools/ShowPackageTools&quot;)]</span><br><span class="line">    static void ShowPackageTools()</span><br><span class="line">    &#123;</span><br><span class="line">        //获取当前窗口实例</span><br><span class="line">        instance=EditorWindow.GetWindow&lt;PackageTools&gt;();</span><br><span class="line">        //显示窗口</span><br><span class="line">        instance.Show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 快速为图片生成图集</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    static void PackgeTextureWidthTag(string tagName)</span><br><span class="line">    &#123;</span><br><span class="line">        //获取所有被选中的物体</span><br><span class="line">        Object[] selection=(Object[])Selection.objects;</span><br><span class="line">        //合法性处理</span><br><span class="line">        if(selection.Length==0) return;</span><br><span class="line">        //批量处理贴图</span><br><span class="line">        foreach(Object obj in selection)</span><br><span class="line">        &#123;</span><br><span class="line">            //取得每一张贴图</span><br><span class="line">            Texture texture=(Texture)obj;</span><br><span class="line">            //获得贴图路径</span><br><span class="line">            string localpath=AssetDatabase.GetAssetPath(texture);</span><br><span class="line">            //贴图导入</span><br><span class="line">            TextureImporter importer=(TextureImporter)AssetImporter.GetAtPath(localpath);</span><br><span class="line">            //判断贴图类型,只有贴图类型为Sprite且精灵类型为SpriteMode</span><br><span class="line">            if(importer.textureType==TextureImporterType.Sprite)</span><br><span class="line">            &#123;</span><br><span class="line">                importer.spritePackingTag=tagName;</span><br><span class="line">                //导入项目资源</span><br><span class="line">                AssetDatabase.ImportAsset(localpath);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //刷新本地资源</span><br><span class="line">        AssetDatabase.Refresh();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //当界面发生变化时重绘</span><br><span class="line">    void OnInspectorUpdate() </span><br><span class="line">    &#123;</span><br><span class="line">        Repaint();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;因为打包图集只需要一个参数，因此这个打包工具只需要一个文本框和一个按钮，整个过程和案例2是一样的，这里就不做分析了。这个扩展程序的演示效果如下：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://7wy477.com1.z0.glb.clouddn.com/imgs_图集打包效果演示.png" alt="图集打包效果演示" title="">
                </div>
                <div class="image-caption">图集打包效果演示</div>
            </figure>
<p>&emsp;&emsp;好了，这就是今天的内容了，今天的内容基本上涵盖了为Unity3D开发扩展程序的基本内容，我们接下来要做的就是积极地在平时生活、工作和学习中寻找问题和解决问题，”授人以鱼不如授人以渔”，向他人传授知识和技能，这件事情本身对博主而言就是是快乐的，博主希望今天的内容大家能够喜欢。好了，谢谢大家！</p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        <p><b>版权声明：</b>
        <a href="http://qinyuanpei.github.io/posts/70687890/" rel="external">Unity3D游戏开发之编辑器扩展程序开发实例</a>
        ，由&nbsp;<a href="/about" target="_blank" rel="external">Payne</a>&nbsp;
        首次发表于&nbsp;<a href="/" target="_blank" rel="external">Payne's Blog</a>&nbsp;
        ，本文地址为：<a href="http://qinyuanpei.github.io/posts/70687890/" target="_blank" rel="external">http://qinyuanpei.github.io/posts/70687890/</a>
        ，转载请注明<b>作者</b>和<b>出处</b>。</p>
    </div>
    <footer>
        <a href="http://qinyuanpei.github.io">
            <img src="/assets/images/avatar.jpg" alt="Payne">
            Payne
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3D/">Unity3D</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/扩展/">扩展</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编辑器/">编辑器</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://qinyuanpei.github.io/posts/70687890/&title=《Unity3D游戏开发之编辑器扩展程序开发实例》 — Payne's Blog&pic=http://qinyuanpei.github.ioassets/images/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://qinyuanpei.github.io/posts/70687890/&title=《Unity3D游戏开发之编辑器扩展程序开发实例》 — Payne's Blog&source=&emsp;&emsp;各位朋友大家好，欢迎关注我的博客，我的博客地址是http://www.qinyuanpei.com。今天我们来说说如何在Unity..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://qinyuanpei.github.io/posts/70687890/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Unity3D游戏开发之编辑器扩展程序开发实例》 — Payne's Blog&url=http://qinyuanpei.github.io/posts/70687890/&via=http://qinyuanpei.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://qinyuanpei.github.io/posts/70687890/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/posts/2799263488/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Unity3D游戏开发之反编译AssetBundle提取游戏资源</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/posts/3356910090/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">从&quot;复活&quot;和&quot;暂停/恢复&quot;谈游戏数据配置管理</h4>
      </a>
    </div>
  
</nav>



    
    <div id="comment"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script type="text/javascript">
new Valine({
    el: '#comment' ,
    notify:false, 
    verify:false, 
    appId: 'JbHqRp2eMrTgIwYpfERH0g79-gzGzoHsz',
    appKey: 'VsiKvLuiBGvJL1XrAfv7siY2',
    placeholder: '',
    path:'70687890', 
    avatar:'mm' 
});
</script>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        赠人玫瑰，手有余香
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/assets/images/geizan.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/assets/images/geizan.jpg" data-alipay="/assets/images/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>
                <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="license">
                    BY-NC-SA
                </a>
            </span>
            <span>
                <a href="https://www.travis-ci.org/qinyuanpei/qinyuanpei.github.io" rel="license">
                    Travis CI
                </a>
            </span>
            <span>
                <a href="https://github.com/qinyuanpei/qinyuanpei.github.io" rel="license">
                    Github
                </a>
            </span>
            <span>
                <a href="https://coding.net/u/qinyuanpei/p/qinyuanpei.coding.me" rel="license">
                    Coding
                </a>
            </span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Payne &copy; 2014 - 2018</span>
            <span>
                
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://qinyuanpei.github.io/posts/70687890/&title=《Unity3D游戏开发之编辑器扩展程序开发实例》 — Payne's Blog&pic=http://qinyuanpei.github.ioassets/images/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://qinyuanpei.github.io/posts/70687890/&title=《Unity3D游戏开发之编辑器扩展程序开发实例》 — Payne's Blog&source=&emsp;&emsp;各位朋友大家好，欢迎关注我的博客，我的博客地址是http://www.qinyuanpei.com。今天我们来说说如何在Unity..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://qinyuanpei.github.io/posts/70687890/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Unity3D游戏开发之编辑器扩展程序开发实例》 — Payne's Blog&url=http://qinyuanpei.github.io/posts/70687890/&via=http://qinyuanpei.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://qinyuanpei.github.io/posts/70687890/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://qinyuanpei.github.io/posts/70687890/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.6/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/assets/scripts/main.min.js?v=1.7.1"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/assets/scripts/search.min.js?v=1.7.1" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
